---
- name: install.redhat | enable required Amazon Linux 2 extras
  ansible.builtin.command: "amazon-linux-extras enable {{ item }} "
  become: yes
  with_items:
    - python3.8
    - postgresql12
  when: ansible_distribution == 'Amazon'

- name: install.redhat | install required system packages
  ansible.builtin.yum:
    name: "{{ item }}"
    state: present
  loop:
    - gcc
    - python38
    - python38-devel
    - python3-pip
    - libxml2-devel
    - libxslt-devel
    - libffi-devel
    - libpq-devel
    - openssl-devel
    - redhat-rpm-config
    - tar # required install on Amazon Linux to untar release

- name: install.redhat | install Git
  ansible.builtin.yum:
    name: git
    state: present
  when: netbox_install_method == 'git'

- name: install.redhat | install system packages for LDAP authentication
  ansible.builtin.yum:
    name: "{{ item }}"
    state: present
  loop:
    - openldap-devel
  when: netbox_auth_ldap is defined
